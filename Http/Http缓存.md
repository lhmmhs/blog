### 强缓存

强缓存阶段，浏览器根据expires响应首部，判断文件是否过期，如果文件没过期，直接使用缓存文件，如果过期，去服务器请求文件。

这个首部表示文件过期的时间，是1个时间戳，它有1个缺陷，服务器和浏览器时间不同步时，无法达到预期的结果。Http1.1新增了Max-age来替代。

Max-age，它表示的是文件的过期时间，但它不是时间戳，而是1个时间长度，单位是秒，假如我们设置3600秒的过期时间，那么当浏览器保存了文件3600秒后，就会判定文件过期，规避了时间戳带来的问题。

### 协商缓存

浏览器第1次发送请求时，服务器响应中会携带Last-Modified首部，它表示文件最后的修改时间，浏览器第2次发送请求时，会携带If-Modified-Sine首部，它是第1次响应的Last-Modified的值，服务器会根据这个请求首部比对，如果不同，说明文件被修改过，返回新的文件；如果相同，说明文件没有被修改过，**返回304状态码**。

这个首部有1个缺陷，文件编辑后，内容没有改变，但是它的修改时间依然会更新，当浏览器再次请求时，会返回新的文件。Http1.1新增了Etag作为Last-modified的补充。

Etag是一种文件的标识，文件内容的实体值，只有当文件内容真正改变的时候，它才会改变。

浏览器第1次请求时，服务器响应中携带Etag首部，浏览器第2次请求时，会携带If-None-Match首部，它是第1次响应的Etag的值，服务器根据该值进行比对，不同，说明文件被修改过，返回新文件；相同，说明文件没有被修改过，**返回304状态码**。

### 参考文章

* [浏览器相关原理(面试题)详细总结一](https://juejin.cn/post/6844903962216824839)