V8的垃圾回收基于分代回收机制，V8将内存分为新生代和老生代。

* 新生代：新创建的对象或只经历过1次的垃圾回收的对象
* 老生代：经历过多次垃圾回收的对象

新生代内存分为From和To两个内存空间，From表示是正在使用的内存，To表示目前闲置的内存。

#### Scavenge 算法

新生代的垃圾回收主要是使用Scavenge 算法，算法步骤：

1. 当From空间被分配满时，检查From内存中的所有对象
2. 若是存活对象，判断是否复合晋升老生代的条件，复制到To中，若是非存活对象，直接回收
3. 复制到To内存中是按照顺序从头放置的
4. 当From所有存活对象复制完成后，From和To就会对调，From被闲置，To在使用

晋升老生代的条件：

* 经历过1次Scavenge算法
* To（闲置内存）内存空间不足75%

#### 标记清除

老生代的垃圾回收主要使用的标记清除算法，算法步骤：

1. 遍历老生代所有对象，做标记
2. 去掉**环境中的变量**和**被环境中的变量引用的对象**的标记
3. 回收依然被标记的对象
4. 整理存活对象

#### 增量标记

V8在进行垃圾回收的时候，会阻塞业务逻辑的执行，如果是老生代垃圾回收会比较繁重，耗时严重影响性能。

增量标记就是为了解决该问题的而提出的技术。它的具体思想是，将原本一口气完成的标记任务分为了很多小的部分去完成, 每完成一个小任务就停一会, 让js逻辑执行一会, 然后再继续执行下面的部分。

#### 参考文章

* [JavaScript进阶-内存机制(表情包初探)](https://juejin.cn/post/6844904033317027854#heading-4)
* [深入理解V8的垃圾回收原理](https://www.jianshu.com/p/b8ed21e8a4fb)

